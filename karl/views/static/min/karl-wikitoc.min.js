/*
 * KARL karl-wikitoc.min.js generated resources http://github.com/karlproject/karl %>
*/
if(function(e){e.fn.drag=function(t,o,i){var n="string"==typeof t?t:"",l=e.isFunction(t)?t:e.isFunction(o)?o:null;return 0!==n.indexOf("drag")&&(n="drag"+n),i=(t==l?o:i)||{},l?this.bind(n,i,l):this.trigger(n)};var t=e.event,o=t.special,i=o.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",livekey:"livedrag",add:function(o){var n=e.data(this,i.datakey),l=o.data||{};n.related+=1,!n.live&&o.selector&&(n.live=!0,t.add(this,"draginit."+i.livekey,i.delegate)),e.each(i.defaults,function(e){void 0!==l[e]&&(n[e]=l[e])})},remove:function(){e.data(this,i.datakey).related-=1},setup:function(){if(!e.data(this,i.datakey)){var o=e.extend({related:0},i.defaults);e.data(this,i.datakey,o),t.add(this,"mousedown",i.init,o),this.attachEvent&&this.attachEvent("ondragstart",i.dontstart)}},teardown:function(){e.data(this,i.datakey).related||(e.removeData(this,i.datakey),t.remove(this,"mousedown",i.init),t.remove(this,"draginit",i.delegate),i.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",i.dontstart))},init:function(n){var l,r=n.data;if(!(r.which>0&&n.which!=r.which||e(n.target).is(r.not)||r.handle&&!e(n.target).closest(r.handle,n.currentTarget).length||(r.propagates=1,r.interactions=[i.interaction(this,r)],r.target=n.target,r.pageX=n.pageX,r.pageY=n.pageY,r.dragging=null,l=i.hijack(n,"draginit",r),!r.propagates)))return l=i.flatten(l),l&&l.length&&(r.interactions=[],e.each(l,function(){r.interactions.push(i.interaction(this,r))})),r.propagates=r.interactions.length,r.drop!==!1&&o.drop&&o.drop.handler(n,r),i.textselect(!1),t.add(document,"mousemove mouseup",i.handler,r),!1},interaction:function(t,o){return{drag:t,callback:new i.callback,droppable:[],offset:e(t)[o.relative?"position":"offset"]()||{top:0,left:0}}},handler:function(e){var n=e.data;switch(e.type){case!n.dragging&&"mousemove":if(Math.pow(e.pageX-n.pageX,2)+Math.pow(e.pageY-n.pageY,2)<Math.pow(n.distance,2))break;e.target=n.target,i.hijack(e,"dragstart",n),n.propagates&&(n.dragging=!0);case"mousemove":if(n.dragging){if(i.hijack(e,"drag",n),n.propagates){n.drop!==!1&&o.drop&&o.drop.handler(e,n);break}e.type="mouseup"}case"mouseup":t.remove(document,"mousemove mouseup",i.handler),n.dragging&&(n.drop!==!1&&o.drop&&o.drop.handler(e,n),i.hijack(e,"dragend",n)),i.textselect(!0),n.click===!1&&n.dragging&&(jQuery.event.triggered=!0,setTimeout(function(){jQuery.event.triggered=!1},20),n.dragging=!1)}},delegate:function(o){var n,l=[],r=e.data(this,"events")||{};return e.each(r.live||[],function(r,a){0===a.preType.indexOf("drag")&&(n=e(o.target).closest(a.selector,o.currentTarget)[0],n&&(t.add(n,a.origType+"."+i.livekey,a.origHandler,a.data),e.inArray(n,l)<0&&l.push(n)))}),l.length?e(l).bind("dragend."+i.livekey,function(){t.remove(this,"."+i.livekey)}):!1},hijack:function(o,n,l,r,a){if(l){var s,c,d,u={event:o.originalEvent,type:o.type},h=n.indexOf("drop")?"drag":"drop",g=r||0,p=isNaN(r)?l.interactions.length:r;o.type=n,o.originalEvent=null,l.results=[];do if(c=l.interactions[g]){if("dragend"!==n&&c.cancelled)continue;d=i.properties(o,l,c),c.results=[],e(a||c[h]||l.droppable).each(function(r,a){return d.target=a,s=a?t.handle.call(a,o,d):null,s===!1?("drag"==h&&(c.cancelled=!0,l.propagates-=1),"drop"==n&&(c[h][r]=null)):"dropinit"==n&&c.droppable.push(i.element(s)||a),"dragstart"==n&&(c.proxy=e(i.element(s)||c.drag)[0]),c.results.push(s),delete o.result,"dropinit"!==n?s:void 0}),l.results[g]=i.flatten(c.results),"dropinit"==n&&(c.droppable=i.flatten(c.droppable)),"dragstart"!=n||c.cancelled||d.update()}while(++g<p);return o.type=u.type,o.originalEvent=u.event,i.flatten(l.results)}},properties:function(e,t,o){var n=o.callback;return n.drag=o.drag,n.proxy=o.proxy||o.drag,n.startX=t.pageX,n.startY=t.pageY,n.deltaX=e.pageX-t.pageX,n.deltaY=e.pageY-t.pageY,n.originalX=o.offset.left,n.originalY=o.offset.top,n.offsetX=e.pageX-(t.pageX-n.originalX),n.offsetY=e.pageY-(t.pageY-n.originalY),n.drop=i.flatten((o.drop||[]).slice()),n.available=i.flatten((o.droppable||[]).slice()),n},element:function(e){return e&&(e.jquery||1==e.nodeType)?e:void 0},flatten:function(t){return e.map(t,function(t){return t&&t.jquery?e.makeArray(t):t&&t.length?i.flatten(t):t})},textselect:function(t){var o=e(document)[t?"unbind":"bind"]("selectstart",i.dontstart);(1!=o.length||o[0]!=document)&&o.attr("unselectable",t?"off":"on").css("MozUserSelect",t?"":"none")},dontstart:function(){return!1},callback:function(){}};i.callback.prototype={update:function(){o.drop&&this.available.length&&e.each(this.available,function(e){o.drop.locate(this,e)})}},o.draginit=o.dragstart=o.dragend=i}(jQuery),function(e){e.fn.drop=function(t,o,i){var n="string"==typeof t?t:"",l=e.isFunction(t)?t:e.isFunction(o)?o:null;return 0!==n.indexOf("drop")&&(n="drop"+n),i=(t==l?o:i)||{},l?this.bind(n,i,l):this.trigger(n)},e.drop=function(t){t=t||{},i.multi=t.multi===!0?1/0:t.multi===!1?1:isNaN(t.multi)?i.multi:t.multi,i.delay=t.delay||i.delay,i.tolerance=e.isFunction(t.tolerance)?t.tolerance:null===t.tolerance?null:i.tolerance,i.mode=t.mode||i.mode||"intersect"};var t=e.event,o=t.special,i=e.event.special.drop={multi:1,delay:20,mode:"overlap",targets:[],datakey:"dropdata",livekey:"livedrop",add:function(o){var n=e.data(this,i.datakey);n.related+=1,!n.live&&o.selector&&(n.live=!0,t.add(this,"dropinit."+i.livekey,i.delegate))},remove:function(){e.data(this,i.datakey).related-=1},setup:function(){e.data(this,i.datakey)||(e.data(this,i.datakey,{related:0,active:[],anyactive:0,winner:0,location:{}}),i.targets.push(this))},teardown:function(){if(!e.data(this,i.datakey).related){e.removeData(this,i.datakey),t.remove(this,"dropinit",i.delegate);var o=this;i.targets=e.grep(i.targets,function(e){return e!==o})}},handler:function(n,l){var r;if(l)switch(n.type){case"mousedown":r=e(i.targets),"string"==typeof l.drop&&(r=r.filter(l.drop)),r.each(function(){var t=e.data(this,i.datakey);t.active=[],t.anyactive=0,t.winner=0}),l.droppable=r,i.delegates=[],o.drag.hijack(n,"dropinit",l),i.delegates=e.unique(o.drag.flatten(i.delegates));break;case"mousemove":i.event=n,i.timer||i.tolerate(l);break;case"mouseup":i.timer=clearTimeout(i.timer),l.propagates&&(o.drag.hijack(n,"drop",l),o.drag.hijack(n,"dropend",l),e.each(i.delegates||[],function(){t.remove(this,"."+i.livekey)}))}},delegate:function(o){var n,l=[],r=e.data(this,"events")||{};return e.each(r.live||[],function(r,a){0===a.preType.indexOf("drop")&&(n=e(o.currentTarget).find(a.selector),n.length&&n.each(function(){t.add(this,a.origType+"."+i.livekey,a.origHandler,a.data),e.inArray(this,l)<0&&l.push(this)}))}),i.delegates.push(l),l.length?e(l):!1},locate:function(t,o){var n=e.data(t,i.datakey),l=e(t),r=l.offset()||{},a=l.outerHeight();return l=l.outerWidth(),r={elem:t,width:l,height:a,top:r.top,left:r.left,right:r.left+l,bottom:r.top+a},n&&(n.location=r,n.index=o,n.elem=t),r},contains:function(e,t){return(t[0]||t.left)>=e.left&&(t[0]||t.right)<=e.right&&(t[1]||t.top)>=e.top&&(t[1]||t.bottom)<=e.bottom},modes:{intersect:function(e,t,o){return this.contains(o,[e.pageX,e.pageY])?1e9:this.modes.overlap.apply(this,arguments)},overlap:function(e,t,o){return Math.max(0,Math.min(o.bottom,t.bottom)-Math.max(o.top,t.top))*Math.max(0,Math.min(o.right,t.right)-Math.max(o.left,t.left))},fit:function(e,t,o){return this.contains(o,t)?1:0},middle:function(e,t,o){return this.contains(o,[t.left+.5*t.width,t.top+.5*t.height])?1:0}},sort:function(e,t){return t.winner-e.winner||e.index-t.index},tolerate:function(t){var n,l,r,a,s,c,d,u=0,h=t.interactions.length,g=[i.event.pageX,i.event.pageY],p=i.tolerance||i.modes[i.mode];do if(d=t.interactions[u]){if(!d)return;d.drop=[],s=[],c=d.droppable.length,p&&(r=i.locate(d.proxy)),n=0;do(l=d.droppable[n])&&(a=e.data(l,i.datakey),(l=a.location)&&(a.winner=p?p.call(i,i.event,r,l):i.contains(l,g)?1:0,s.push(a)));while(++n<c);s.sort(i.sort),n=0;do(a=s[n])&&(a.winner&&d.drop.length<i.multi?(a.active[u]||a.anyactive||(o.drag.hijack(i.event,"dropstart",t,u,a.elem)[0]!==!1?(a.active[u]=1,a.anyactive+=1):a.winner=0),a.winner&&d.drop.push(a.elem)):a.active[u]&&1==a.anyactive&&(o.drag.hijack(i.event,"dropend",t,u,a.elem),a.active[u]=0,a.anyactive-=1));while(++n<c)}while(++u<h);i.last&&g[0]==i.last.pageX&&g[1]==i.last.pageY?delete i.timer:i.timer=setTimeout(function(){i.tolerate(t)},i.delay),i.last=i.event}};o.dropinit=o.dropstart=o.dropend=i}(jQuery),function(e){function t(){var e=!1,t=!1;this.stopPropagation=function(){e=!0},this.isPropagationStopped=function(){return e},this.stopImmediatePropagation=function(){t=!0},this.isImmediatePropagationStopped=function(){return t}}function o(){var e=[];this.subscribe=function(t){e.push(t)},this.unsubscribe=function(t){for(var o=e.length-1;o>=0;o--)e[o]===t&&e.splice(o,1)},this.notify=function(o,i,n){i=i||new t,n=n||this;for(var l,r=0;r<e.length&&!i.isPropagationStopped()&&!i.isImmediatePropagationStopped();r++)l=e[r].call(n,i,o);return l}}function i(e,t,o,i){void 0===o&&void 0===i&&(o=e,i=t),this.fromRow=Math.min(e,o),this.fromCell=Math.min(t,i),this.toRow=Math.max(e,o),this.toCell=Math.max(t,i),this.isSingleRow=function(){return this.fromRow==this.toRow},this.isSingleCell=function(){return this.fromRow==this.toRow&&this.fromCell==this.toCell},this.contains=function(e,t){return e>=this.fromRow&&e<=this.toRow&&t>=this.fromCell&&t<=this.toCell},this.toString=function(){return this.isSingleCell()?"("+this.fromRow+":"+this.fromCell+")":"("+this.fromRow+":"+this.fromCell+" - "+this.toRow+":"+this.toCell+")"}}function n(){this.__nonDataRow=!0}function l(){this.__group=!0,this.__updated=!1,this.count=0,this.value=null,this.title=null,this.collapsed=!1,this.totals=null}function r(){this.__groupTotals=!0,this.group=null}function a(){var e=null;this.isActive=function(t){return t?e===t:null!==e},this.activate=function(t){if(t!==e){if(null!==e)throw"SlickGrid.EditorLock.activate: an editController is still active, can't activate another editController";if(!t.commitCurrentEdit)throw"SlickGrid.EditorLock.activate: editController must implement .commitCurrentEdit()";if(!t.cancelCurrentEdit)throw"SlickGrid.EditorLock.activate: editController must implement .cancelCurrentEdit()";e=t}},this.deactivate=function(t){if(e!==t)throw"SlickGrid.EditorLock.deactivate: specified editController is not the currently active one";e=null},this.commitCurrentEdit=function(){return e?e.commitCurrentEdit():!0},this.cancelCurrentEdit=function(){return e?e.cancelCurrentEdit():!0}}e.extend(!0,window,{Slick:{Event:o,EventData:t,Range:i,NonDataRow:n,Group:l,GroupTotals:r,EditorLock:a,GlobalEditorLock:new a}}),l.prototype=new n,l.prototype.equals=function(e){return this.value===e.value&&this.count===e.count&&this.collapsed===e.collapsed},r.prototype=new n}(jQuery),"undefined"==typeof jQuery)throw"SlickGrid requires jquery module to be loaded";if(!jQuery.fn.drag)throw"SlickGrid requires jquery.event.drag module to be loaded";if("undefined"==typeof Slick)throw"slick.core.js not loaded";!function($){function SlickGrid(container,data,columns,options){function init(){if($container=$(container),$container.length<1)throw new Error("SlickGrid requires a valid container, "+container+" does not exist in the DOM.");if(maxSupportedCssHeight=getMaxSupportedCssHeight(),scrollbarDimensions=scrollbarDimensions||measureScrollbar(),options=$.extend({},defaults,options),columnDefaults.width=options.defaultColumnWidth,options.enableColumnReorder&&!$.fn.sortable)throw new Error('SlickGrid\'s "enableColumnReorder = true" option requires jquery-ui.sortable module to be loaded');editController={commitCurrentEdit:commitCurrentEdit,cancelCurrentEdit:cancelCurrentEdit},$container.empty().attr("tabIndex",0).attr("hideFocus",!0).css("overflow","hidden").css("outline",0).addClass(uid).addClass("ui-widget"),/relative|absolute|fixed/.test($container.css("position"))||$container.css("position","relative"),$headerScroller=$("<div class='slick-header ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($container),$headers=$("<div class='slick-header-columns' style='width:10000px; left:-1000px' />").appendTo($headerScroller),$headerRowScroller=$("<div class='slick-headerrow ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($container),$headerRow=$("<div class='slick-headerrow-columns' style='width:10000px;' />").appendTo($headerRowScroller),$topPanelScroller=$("<div class='slick-top-panel-scroller ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($container),$topPanel=$("<div class='slick-top-panel' style='width:10000px' />").appendTo($topPanelScroller),options.showTopPanel||$topPanelScroller.hide(),options.showHeaderRow||$headerRowScroller.hide(),$viewport=$("<div class='slick-viewport' tabIndex='0' hideFocus style='width:100%;overflow-x:auto;outline:0;position:relative;overflow-y:auto;'>").appendTo($container),$canvas=$("<div class='grid-canvas' tabIndex='0' hideFocus />").appendTo($viewport),measureCellPaddingAndBorder(),disableSelection($headers),options.enableTextSelectionOnCells||$viewport.bind("selectstart.ui",function(e){return $(e.target).is("input,textarea")}),viewportW=parseFloat($.css($container[0],"width",!0)),createColumnHeaders(),setupColumnSort(),createCssRules(),resizeAndRender(),bindAncestorScrollEvents(),$viewport.bind("scroll.slickgrid",handleScroll),$container.bind("resize.slickgrid",resizeAndRender),$headerScroller.bind("contextmenu.slickgrid",handleHeaderContextMenu).bind("click.slickgrid",handleHeaderClick),$canvas.bind("keydown.slickgrid",handleKeyDown).bind("click.slickgrid",handleClick).bind("dblclick.slickgrid",handleDblClick).bind("contextmenu.slickgrid",handleContextMenu).bind("draginit",handleDragInit).bind("dragstart",handleDragStart).bind("drag",handleDrag).bind("dragend",handleDragEnd),$canvas.delegate(".slick-cell","mouseenter",handleMouseEnter),$canvas.delegate(".slick-cell","mouseleave",handleMouseLeave)}function registerPlugin(e){plugins.unshift(e),e.init(self)}function unregisterPlugin(e){for(var t=plugins.length;t>=0;t--)if(plugins[t]===e){plugins[t].destroy&&plugins[t].destroy(),plugins.splice(t,1);break}}function setSelectionModel(e){selectionModel&&(selectionModel.onSelectedRangesChanged.unsubscribe(handleSelectedRangesChanged),selectionModel.destroy&&selectionModel.destroy()),selectionModel=e,selectionModel.init(self),selectionModel.onSelectedRangesChanged.subscribe(handleSelectedRangesChanged)}function getSelectionModel(){return selectionModel}function getCanvasNode(){return $canvas[0]}function measureScrollbar(){var e=$("<div style='position:absolute; top:-10000px; left:-10000px; width:100px; height:100px; overflow:scroll;'></div>").appendTo("body"),t={width:e.width()-e[0].clientWidth,height:e.height()-e[0].clientHeight};return e.remove(),t}function getRowWidth(){for(var e=0,t=columns.length;t--;)e+=columns[t].width||columnDefaults.width;return e}function setCanvasWidth(e){$canvas.width(e),viewportHasHScroll=e>viewportW-scrollbarDimensions.width}function disableSelection(e){e&&e.jquery&&e.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}function getMaxSupportedCssHeight(){for(var e=1e6,t=e,o=$.browser.mozilla?5e6:1e9,i=$("<div style='display:none' />").appendTo(document.body);o>=t&&(i.css("height",t+e),i.height()===t+e);)t+=e;return i.remove(),t}function bindAncestorScrollEvents(){for(var e=$canvas[0];(e=e.parentNode)!=document.body;)(e==$viewport[0]||e.scrollWidth!=e.clientWidth||e.scrollHeight!=e.clientHeight)&&$(e).bind("scroll.slickgrid",handleActiveCellPositionChange)}function unbindAncestorScrollEvents(){$canvas.parents().unbind("scroll.slickgrid")}function updateColumnHeader(e,t,o){var i=getColumnIndex(e),n=$headers.children().eq(i);n&&(columns[i].name=t,columns[i].toolTip=o,n.attr("title",o||t||"").children().eq(0).html(t))}function getHeaderRow(){return $headerRow[0]}function getHeaderRowColumn(e){var t=getColumnIndex(e),o=$headerRow.children().eq(t);return o&&o[0]}function createColumnHeaders(){function e(){$(this).addClass("ui-state-hover")}function t(){$(this).removeClass("ui-state-hover")}var o;for($headers.empty(),$headerRow.empty(),columnsById={},o=0;o<columns.length;o++){var i=columns[o]=$.extend({},columnDefaults,columns[o]);columnsById[i.id]=o;var n=$("<div class='ui-state-default slick-header-column' id='"+uid+i.id+"' />").html("<span class='slick-column-name'>"+i.name+"</span>").width(i.width-headerColumnWidthDiff).attr("title",i.toolTip||i.name||"").data("fieldId",i.id).addClass(i.headerCssClass||"").appendTo($headers);(options.enableColumnReorder||i.sortable)&&n.hover(e,t),i.sortable&&n.append("<span class='slick-sort-indicator' />"),options.showHeaderRow&&$("<div class='ui-state-default slick-headerrow-column c"+o+"'></div>").appendTo($headerRow)}setSortColumn(sortColumnId,sortAsc),setupColumnResize(),options.enableColumnReorder&&setupColumnReorder()}function setupColumnSort(){$headers.click(function(e){if(!$(e.target).hasClass("slick-resizable-handle")){var t=$(e.target).closest(".slick-header-column");if(t.length){var o=columns[getColumnIndex(t.data("fieldId"))];if(o.sortable){if(!getEditorLock().commitCurrentEdit())return;o.id===sortColumnId?sortAsc=!sortAsc:(sortColumnId=o.id,sortAsc=!0),setSortColumn(sortColumnId,sortAsc),trigger(self.onSort,{sortCol:o,sortAsc:sortAsc})}}}})}function setupColumnReorder(){$headers.sortable({containment:"parent",axis:"x",cursor:"default",tolerance:"intersection",helper:"clone",placeholder:"slick-sortable-placeholder ui-state-default slick-header-column",forcePlaceholderSize:!0,start:function(e,t){$(t.helper).addClass("slick-header-column-active")},beforeStop:function(e,t){$(t.helper).removeClass("slick-header-column-active")},stop:function(e){if(!getEditorLock().commitCurrentEdit())return void $(this).sortable("cancel");for(var t=$headers.sortable("toArray"),o=[],i=0;i<t.length;i++)o.push(columns[getColumnIndex(t[i].replace(uid,""))]);setColumns(o),trigger(self.onColumnsReordered,{}),e.stopPropagation(),setupColumnResize()}})}function setupColumnResize(){var e,t,o,i,n,l,r,a,s,c;n=$headers.children(),n.find(".slick-resizable-handle").remove(),n.each(function(e){columns[e].resizable&&(void 0===a&&(a=e),s=e)}),void 0!==a&&n.each(function(d,u){a>d||options.forceFitColumns&&d>=s||(e=$(u),$("<div class='slick-resizable-handle' />").appendTo(u).bind("dragstart",function(e){if(!getEditorLock().commitCurrentEdit())return!1;i=e.pageX,$(this).parent().addClass("slick-header-column-active");var a=null,s=null;if(n.each(function(e,t){columns[e].previousWidth=$(t).outerWidth()}),options.forceFitColumns)for(a=0,s=0,t=d+1;t<n.length;t++)o=columns[t],o.resizable&&(null!==s&&(o.maxWidth?s+=o.maxWidth-o.previousWidth:s=null),a+=o.previousWidth-Math.max(o.minWidth||0,absoluteColumnMinWidth));var u=0,h=0;for(t=0;d>=t;t++)o=columns[t],o.resizable&&(null!==h&&(o.maxWidth?h+=o.maxWidth-o.previousWidth:h=null),u+=o.previousWidth-Math.max(o.minWidth||0,absoluteColumnMinWidth));null===a&&(a=1e5),null===u&&(u=1e5),null===s&&(s=1e5),null===h&&(h=1e5),r=i+Math.min(a,h),l=i-Math.min(u,s),c=$canvas.width()}).bind("drag",function(e){var a,s,u=Math.min(r,Math.max(l,e.pageX))-i;if(0>u){for(s=u,t=d;t>=0;t--)o=columns[t],o.resizable&&(a=Math.max(o.minWidth||0,absoluteColumnMinWidth),s&&o.previousWidth+s<a?(s+=o.previousWidth-a,o.width=a):(o.width=o.previousWidth+s,s=0));if(options.forceFitColumns)for(s=-u,t=d+1;t<n.length;t++)o=columns[t],o.resizable&&(s&&o.maxWidth&&o.maxWidth-o.previousWidth<s?(s-=o.maxWidth-o.previousWidth,o.width=o.maxWidth):(o.width=o.previousWidth+s,s=0));else options.syncColumnCellResize&&setCanvasWidth(c+u)}else{for(s=u,t=d;t>=0;t--)o=columns[t],o.resizable&&(s&&o.maxWidth&&o.maxWidth-o.previousWidth<s?(s-=o.maxWidth-o.previousWidth,o.width=o.maxWidth):(o.width=o.previousWidth+s,s=0));if(options.forceFitColumns)for(s=-u,t=d+1;t<n.length;t++)o=columns[t],o.resizable&&(a=Math.max(o.minWidth||0,absoluteColumnMinWidth),s&&o.previousWidth+s<a?(s+=o.previousWidth-a,o.width=a):(o.width=o.previousWidth+s,s=0));else options.syncColumnCellResize&&setCanvasWidth(c+u)}applyColumnHeaderWidths(),options.syncColumnCellResize&&applyColumnWidths()}).bind("dragend",function(){var e;for($(this).parent().removeClass("slick-header-column-active"),t=0;t<n.length;t++)o=columns[t],e=$(n[t]).outerWidth(),o.previousWidth!==e&&o.rerenderOnResize&&invalidateAllRows();applyColumnWidths(),resizeCanvas(),trigger(self.onColumnsResized,{})}))})}function getVBoxDelta(e){var t=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],o=0;return $.each(t,function(t,i){o+=parseFloat(e.css(i))||0}),o}function measureCellPaddingAndBorder(){var e,t=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],o=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"];e=$("<div class='ui-state-default slick-header-column' style='visibility:hidden'>-</div>").appendTo($headers),headerColumnWidthDiff=headerColumnHeightDiff=0,$.each(t,function(t,o){headerColumnWidthDiff+=parseFloat(e.css(o))||0}),$.each(o,function(t,o){headerColumnHeightDiff+=parseFloat(e.css(o))||0}),e.remove();var i=$("<div class='slick-row' />").appendTo($canvas);e=$("<div class='slick-cell' id='' style='visibility:hidden'>-</div>").appendTo(i),cellWidthDiff=cellHeightDiff=0,$.each(t,function(t,o){cellWidthDiff+=parseFloat(e.css(o))||0}),$.each(o,function(t,o){cellHeightDiff+=parseFloat(e.css(o))||0}),i.remove(),absoluteColumnMinWidth=Math.max(headerColumnWidthDiff,cellWidthDiff)}function createCssRules(){$style=$("<style type='text/css' rel='stylesheet' />").appendTo($("head"));for(var e,t=options.rowHeight-cellHeightDiff,o=["."+uid+" .slick-header-column { left: 1000px; }","."+uid+" .slick-top-panel { height:"+options.topPanelHeight+"px; }","."+uid+" .slick-headerrow-columns { height:"+options.headerRowHeight+"px; }","."+uid+" .slick-cell { height:"+t+"px; }","."+uid+" .slick-row { width:"+getRowWidth()+"px; }","."+uid+" .lr { float:none; position:absolute; }"],i=getRowWidth(),n=0,l=0;l<columns.length;l++)e=columns[l].width,o.push("."+uid+" .l"+l+" { left: "+n+"px; }"),o.push("."+uid+" .r"+l+" { right: "+(i-n-e)+"px; }"),o.push("."+uid+" .c"+l+" { width:"+(e-cellWidthDiff)+"px; }"),n+=columns[l].width;$style[0].styleSheet?$style[0].styleSheet.cssText=o.join(" "):$style[0].appendChild(document.createTextNode(o.join(" ")));for(var r=document.styleSheets,l=0;l<r.length;l++)if((r[l].ownerNode||r[l].owningElement)==$style[0]){stylesheet=r[l];break}}function findCssRule(e){for(var t=stylesheet.cssRules||stylesheet.rules,o=0;o<t.length;o++)if(t[o].selectorText==e)return t[o];return null}function removeCssRules(){$style.remove()}function destroy(){getEditorLock().cancelCurrentEdit(),trigger(self.onBeforeDestroy,{});for(var e=0;e<plugins.length;e++)unregisterPlugin(plugins[e]);options.enableColumnReorder&&$headers.sortable&&$headers.sortable("destroy"),unbindAncestorScrollEvents(),$container.unbind(".slickgrid"),removeCssRules(),$canvas.unbind("draginit dragstart dragend drag"),$container.empty().removeClass(uid)}function trigger(e,t,o){return o=o||new Slick.EventData,t=t||{},t.grid=self,e.notify(t,o,self)}function getEditorLock(){return options.editorLock}function getEditController(){return editController}function getColumnIndex(e){return columnsById[e]}function autosizeColumns(){var e,t,o=[],i=0,n=options.autoHeight?viewportW:viewportW-scrollbarDimensions.width,l=0,r=0;for(e=0;e<columns.length;e++)t=columns[e],o.push(t.width),r+=t.width,i+=t.width-Math.max(t.minWidth||0,absoluteColumnMinWidth);for(l=r,invalidateAllRows();l>n;){if(!i)return;var a=(l-n)/i;for(e=0;e<columns.length&&l>n;e++)if(t=columns[e],t.resizable&&t.minWidth!==t.width&&t.width!==absoluteColumnMinWidth){var s=Math.floor(a*(t.width-Math.max(t.minWidth||0,absoluteColumnMinWidth)))||1;l-=s,o[e]-=s}}for(var c=l;n>l;){var d=n/l;for(e=0;e<columns.length&&n>l;e++)if(t=columns[e],t.resizable&&!(t.maxWidth<=t.width)){var u=Math.min(Math.floor(d*t.width)-t.width,t.maxWidth-t.width||1e6)||1;l+=u,o[e]+=u}if(c==l)break;c=l}for(e=0;e<columns.length;e++)columns[e].width=o[e];applyColumnHeaderWidths(),applyColumnWidths(),resizeCanvas()}function applyColumnHeaderWidths(){for(var e,t=0,o=$headers.children(),i=o.length;i>t;t++)e=$(o[t]),e.width()!==columns[t].width-headerColumnWidthDiff&&e.width(columns[t].width-headerColumnWidthDiff)}function applyColumnWidths(){for(var e,t,o=getRowWidth(),i=0,n=0;n<columns.length;n++)e=columns[n].width,t=findCssRule("."+uid+" .c"+n),t.style.width=e-cellWidthDiff+"px",t=findCssRule("."+uid+" .l"+n),t.style.left=i+"px",t=findCssRule("."+uid+" .r"+n),t.style.right=o-i-e+"px",i+=columns[n].width;t=findCssRule("."+uid+" .slick-row"),t.style.width=o+"px"}function setSortColumn(e,t){sortColumnId=e,sortAsc=t;var o=getColumnIndex(sortColumnId);$headers.children().removeClass("slick-header-column-sorted"),$headers.find(".slick-sort-indicator").removeClass("slick-sort-indicator-asc slick-sort-indicator-desc"),null!=o&&$headers.children().eq(o).addClass("slick-header-column-sorted").find(".slick-sort-indicator").addClass(sortAsc?"slick-sort-indicator-asc":"slick-sort-indicator-desc")}function handleSelectedRangesChanged(e,t){selectedRows=[];for(var o={},i=0;i<t.length;i++)for(var n=t[i].fromRow;n<=t[i].toRow;n++){o[n]||selectedRows.push(n),o[n]={};for(var l=t[i].fromCell;l<=t[i].toCell;l++)canCellBeSelected(n,l)&&(o[n][columns[l].id]=options.selectedCellCssClass)}setCellCssStyles(options.selectedCellCssClass,o),trigger(self.onSelectedRowsChanged,{rows:getSelectedRows()},e)}function getColumns(){return columns}function setColumns(e){columns=e,invalidateAllRows(),createColumnHeaders(),removeCssRules(),createCssRules(),resizeAndRender(),handleScroll()}function getOptions(){return options}function setOptions(e){getEditorLock().commitCurrentEdit()&&(makeActiveCellNormal(),options.enableAddRow!==e.enableAddRow&&invalidateRow(getDataLength()),options=$.extend(options,e),render())}function setData(e,t){invalidateAllRows(),data=e,t&&scrollTo(0)}function getData(){return data}function getDataLength(){return data.getLength?data.getLength():data.length}function getDataItem(e){return data.getItem?data.getItem(e):data[e]}function getTopPanel(){return $topPanel[0]}function showTopPanel(){options.showTopPanel=!0,$topPanelScroller.slideDown("fast",resizeCanvas)}function hideTopPanel(){options.showTopPanel=!1,$topPanelScroller.slideUp("fast",resizeCanvas)}function showHeaderRowColumns(){options.showHeaderRow=!0,$headerRowScroller.slideDown("fast",resizeCanvas)}function hideHeaderRowColumns(){options.showHeaderRow=!1,$headerRowScroller.slideUp("fast",resizeCanvas)}function scrollTo(e){var t=offset;page=Math.min(n-1,Math.floor(e/ph)),offset=Math.round(page*cj);var o=e-offset;if(offset!=t){var i=getVisibleRange(o);cleanupRows(i.top,i.bottom),updateRowPositions()}prevScrollTop!=o&&(scrollDir=o+offset>prevScrollTop+t?1:-1,$viewport[0].scrollTop=lastRenderedScrollTop=scrollTop=prevScrollTop=o,trigger(self.onViewportChanged,{}))}function defaultFormatter(e,t,o){return null===o||void 0===o?"":o}function getFormatter(e,t){var o=data.getItemMetadata&&data.getItemMetadata(e),i=o&&o.columns&&(o.columns[t.id]||o.columns[getColumnIndex(t.id)]);return i&&i.formatter||o&&o.formatter||t.formatter||options.formatterFactory&&options.formatterFactory.getFormatter(t)||defaultFormatter}function getEditor(e,t){var o=columns[t],i=data.getItemMetadata&&data.getItemMetadata(e),n=i&&i.columns;return n&&n[o.id]&&void 0!==n[o.id].editor?n[o.id].editor:n&&n[t]&&void 0!==n[t].editor?n[t].editor:o.editor||options.editorFactory&&options.editorFactory.getEditor(o)}function appendRowHtml(e,t){var o,i=getDataItem(t),n=t<getDataLength()&&!i,l="slick-row "+(n?" loading":"")+(t%2==1?" odd":" even"),r=data.getItemMetadata&&data.getItemMetadata(t);r&&r.cssClasses&&(l+=" "+r.cssClasses),e.push("<div class='ui-widget-content "+l+"' row='"+t+"' style='top:"+(options.rowHeight*t-offset)+"px'>");for(var a,s=(r&&r.columns,0),c=columns.length;c>s;s++){var d=columns[s];a=getColspan(t,s),o="slick-cell lr l"+s+" r"+Math.min(columns.length-1,s+a-1)+(d.cssClass?" "+d.cssClass:""),t===activeRow&&s===activeCell&&(o+=" active");for(var u in cellCssClasses)cellCssClasses[u][t]&&cellCssClasses[u][t][d.id]&&(o+=" "+cellCssClasses[u][t][d.id]);e.push("<div class='"+o+"'>"),i&&e.push(getFormatter(t,d)(t,s,i[d.field],d,i)),e.push("</div>"),a&&(s+=a-1)}e.push("</div>")}function cleanupRows(e){for(var t in rowsCache)(t=parseInt(t,10))!==activeRow&&(t<e.top||t>e.bottom)&&removeRowFromCache(t)}function invalidate(){updateRowCount(),invalidateAllRows(),render()}function invalidateAllRows(){currentEditor&&makeActiveCellNormal();for(var e in rowsCache)removeRowFromCache(e)}function removeRowFromCache(e){var t=rowsCache[e];t&&($canvas[0].removeChild(t),delete rowsCache[e],delete postProcessedRows[e],renderedRows--,counter_rows_removed++)}function invalidateRows(e){var t,o;if(e&&e.length)for(scrollDir=0,t=0,o=e.length;o>t;t++)currentEditor&&activeRow===t&&makeActiveCellNormal(),rowsCache[e[t]]&&removeRowFromCache(e[t])}function invalidateRow(e){invalidateRows([e])}function updateCell(e,t){var o=getCellNode(e,t);if(o){var i=columns[t],n=getDataItem(e);currentEditor&&activeRow===e&&activeCell===t?currentEditor.loadValue(n):(o.innerHTML=n?getFormatter(e,i)(e,t,n[i.field],i,n):"",invalidatePostProcessingResults(e))}}function updateRow(e){rowsCache[e]&&($(rowsCache[e]).children().each(function(t){var o=columns[t];e===activeRow&&t===activeCell&&currentEditor?currentEditor.loadValue(getDataItem(activeRow)):this.innerHTML=getDataItem(e)?getFormatter(e,o)(e,t,getDataItem(e)[o.field],o,getDataItem(e)):""}),invalidatePostProcessingResults(e))}function getViewportHeight(){return parseFloat($.css($container[0],"height",!0))-options.headerHeight-getVBoxDelta($headers)-(options.showTopPanel?options.topPanelHeight+getVBoxDelta($topPanelScroller):0)-(options.showHeaderRow?options.headerRowHeight+getVBoxDelta($headerRowScroller):0)}function resizeCanvas(){viewportH=options.autoHeight?options.rowHeight*(getDataLength()+(options.enableAddRow?1:0)+(options.leaveSpaceForNewRows?numVisibleRows-1:0)):getViewportHeight(),numVisibleRows=Math.ceil(viewportH/options.rowHeight),viewportW=parseFloat($.css($container[0],"width",!0)),$viewport.height(viewportH);for(var e=0,t=columns.length;t--;)e+=columns[t].width;setCanvasWidth(e),updateRowCount(),render()}function resizeAndRender(){options.forceFitColumns?autosizeColumns():resizeCanvas()}function updateRowCount(){var e=getDataLength()+(options.enableAddRow?1:0)+(options.leaveSpaceForNewRows?numVisibleRows-1:0),t=h,o=options.enableAddRow?getDataLength():getDataLength()-1;for(var i in rowsCache)i>=o&&removeRowFromCache(i);th=Math.max(options.rowHeight*e,viewportH-scrollbarDimensions.height),maxSupportedCssHeight>th?(h=ph=th,n=1,cj=0):(h=maxSupportedCssHeight,ph=h/100,n=Math.floor(th/ph),cj=(th-h)/(n-1)),h!==t&&($canvas.css("height",h),scrollTop=$viewport[0].scrollTop);var l=th-viewportH>=scrollTop+offset;0==th||0==scrollTop?page=offset=0:scrollTo(l?scrollTop+offset:th-viewportH),h!=t&&options.autoHeight&&resizeCanvas()}function getVisibleRange(e){return null==e&&(e=scrollTop),{top:Math.floor((scrollTop+offset)/options.rowHeight),bottom:Math.ceil((scrollTop+offset+viewportH)/options.rowHeight)}}function getRenderedRange(e){var t=getVisibleRange(e),o=Math.round(viewportH/options.rowHeight),i=3;return-1==scrollDir?(t.top-=o,t.bottom+=i):1==scrollDir?(t.top-=i,t.bottom+=o):(t.top-=i,t.bottom+=i),t.top=Math.max(0,t.top),t.bottom=Math.min(options.enableAddRow?getDataLength():getDataLength()-1,t.bottom),t}function renderRows(e){var t,o=$canvas[0],i=renderedRows,n=[],l=[],r=new Date,a=!1;for(t=e.top;t<=e.bottom;t++)rowsCache[t]||(renderedRows++,l.push(t),appendRowHtml(n,t),activeCellNode&&activeRow===t&&(a=!0),counter_rows_rendered++);var s=document.createElement("div");s.innerHTML=n.join("");for(var t=0;s.firstChild;)try{rowsCache[l[t]]=o.appendChild(s.firstChild),t+=1}catch(c){throw c
}a&&(activeCellNode=getCellNode(activeRow,activeCell)),renderedRows-i>5&&(avgRowRenderTime=(new Date-r)/(renderedRows-i))}function startPostProcessing(){options.enableAsyncPostRender&&(clearTimeout(h_postrender),h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay))}function invalidatePostProcessingResults(e){delete postProcessedRows[e],postProcessFromRow=Math.min(postProcessFromRow,e),postProcessToRow=Math.max(postProcessToRow,e),startPostProcessing()}function updateRowPositions(){for(var e in rowsCache)rowsCache[e].style.top=e*options.rowHeight-offset+"px"}function render(){var e=getVisibleRange(),t=getRenderedRange();cleanupRows(t),renderRows(t),postProcessFromRow=e.top,postProcessToRow=Math.min(options.enableAddRow?getDataLength():getDataLength()-1,e.bottom),startPostProcessing(),lastRenderedScrollTop=scrollTop,h_render=null}function handleScroll(){scrollTop=$viewport[0].scrollTop;var e=$viewport[0].scrollLeft,t=Math.abs(scrollTop-prevScrollTop);if(e!==prevScrollLeft&&(prevScrollLeft=e,$headerScroller[0].scrollLeft=e,$topPanelScroller[0].scrollLeft=e,$headerRowScroller[0].scrollLeft=e),t){if(scrollDir=scrollTop>prevScrollTop?1:-1,prevScrollTop=scrollTop,viewportH>t)scrollTo(scrollTop+offset);else{var o=offset;page=Math.min(n-1,Math.floor(scrollTop*((th-viewportH)/(h-viewportH))*(1/ph))),offset=Math.round(page*cj),o!=offset&&invalidateAllRows()}h_render&&clearTimeout(h_render),Math.abs(lastRenderedScrollTop-scrollTop)<viewportH?render():h_render=setTimeout(render,50),trigger(self.onViewportChanged,{})}trigger(self.onScroll,{scrollLeft:e,scrollTop:scrollTop})}function asyncPostProcessRows(){for(;postProcessToRow>=postProcessFromRow;){var e=scrollDir>=0?postProcessFromRow++:postProcessToRow--,t=rowsCache[e];if(!(!t||postProcessedRows[e]||e>=getDataLength())){for(var o=getDataItem(e),i=t.childNodes,n=0,l=0,r=columns.length;r>n;++n){var a=columns[n];a.asyncPostRender&&a.asyncPostRender(i[l],postProcessFromRow,o,a),++l}return postProcessedRows[e]=!0,void(h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay))}}}function addCellCssStyles(e,t){if(cellCssClasses[e])throw"addCellCssStyles: cell CSS hash with key '"+e+"' already exists.";cellCssClasses[e]=t;var o;for(var i in rowsCache)if(t[i])for(var n in t[i])o=getCellNode(i,getColumnIndex(n)),o&&$(o).addClass(t[i][n])}function removeCellCssStyles(e){if(cellCssClasses[e]){var t;for(var o in rowsCache)if(cellCssClasses[e][o])for(var i in cellCssClasses[e][o])t=getCellNode(o,getColumnIndex(i)),t&&$(t).removeClass(cellCssClasses[e][o][i]);delete cellCssClasses[e]}}function setCellCssStyles(e,t){removeCellCssStyles(e),addCellCssStyles(e,t)}function flashCell(e,t,o){function i(e){e&&setTimeout(function(){n.queue(function(){n.toggleClass(options.cellFlashingCssClass).dequeue(),i(e-1)})},o)}if(o=o||100,rowsCache[e]){var n=$(getCellNode(e,t));i(4)}}function handleDragInit(e,t){var o=getCellFromEvent(e);return o&&cellExists(o.row,o.cell)?(retval=trigger(self.onDragInit,t,e),e.isImmediatePropagationStopped()?retval:!1):!1}function handleDragStart(e,t){var o=getCellFromEvent(e);if(!o||!cellExists(o.row,o.cell))return!1;var i=trigger(self.onDragStart,t,e);return e.isImmediatePropagationStopped()?i:!1}function handleDrag(e,t){return trigger(self.onDrag,t,e)}function handleDragEnd(e,t){trigger(self.onDragEnd,t,e)}function handleKeyDown(e){trigger(self.onKeyDown,{},e);var t=e.isImmediatePropagationStopped();if(!t)if(e.shiftKey||e.altKey||e.ctrlKey){if(9!=e.which||!e.shiftKey||e.ctrlKey||e.altKey)return;navigatePrev()}else if(27==e.which){if(!getEditorLock().isActive())return;cancelEditAndSetFocus()}else if(37==e.which)navigateLeft();else if(39==e.which)navigateRight();else if(38==e.which)navigateUp();else if(40==e.which)navigateDown();else if(9==e.which)navigateNext();else{if(13!=e.which)return;options.editable&&(currentEditor?activeRow===getDataLength()?navigateDown():commitEditAndSetFocus():getEditorLock().commitCurrentEdit()&&makeActiveCellEditable())}e.stopPropagation(),e.preventDefault();try{e.originalEvent.keyCode=0}catch(o){}}function handleClick(e){var t=getCellFromEvent(e);!t||null!==currentEditor&&activeRow==t.row&&activeCell==t.cell||(trigger(self.onClick,{row:t.row,cell:t.cell},e),e.isImmediatePropagationStopped()||canCellBeActive(t.row,t.cell)&&(!getEditorLock().isActive()||getEditorLock().commitCurrentEdit())&&(scrollRowIntoView(t.row,!1),setActiveCellInternal(getCellNode(t.row,t.cell),t.row===getDataLength()||options.autoEdit)))}function handleContextMenu(e){var t=$(e.target).closest(".slick-cell",$canvas);0!==t.length&&(activeCellNode!==t[0]||null===currentEditor)&&trigger(self.onContextMenu,{},e)}function handleDblClick(e){var t=getCellFromEvent(e);!t||null!==currentEditor&&activeRow==t.row&&activeCell==t.cell||(trigger(self.onDblClick,{row:t.row,cell:t.cell},e),e.isImmediatePropagationStopped()||options.editable&&gotoCell(t.row,t.cell,!0))}function handleHeaderContextMenu(e){var t=$(e.target).closest(".slick-header-column",".slick-header-columns"),o=t&&columns[self.getColumnIndex(t.data("fieldId"))];trigger(self.onHeaderContextMenu,{column:o},e)}function handleHeaderClick(e){var t=$(e.target).closest(".slick-header-column",".slick-header-columns"),o=t&&columns[self.getColumnIndex(t.data("fieldId"))];trigger(self.onHeaderClick,{column:o},e)}function handleMouseEnter(e){trigger(self.onMouseEnter,{},e)}function handleMouseLeave(e){trigger(self.onMouseLeave,{},e)}function cellExists(e,t){return!(0>e||e>=getDataLength()||0>t||t>=columns.length)}function getCellFromPoint(e,t){for(var o=Math.floor((t+offset)/options.rowHeight),i=0,n=0,l=0;l<columns.length&&e>n;l++)n+=columns[l].width,i++;return 0>i&&(i=0),{row:o,cell:i-1}}function getCellFromNode(e){var t=/l\d+/.exec(e.className)||/c\d+/.exec(e.className);if(!t)throw"getCellFromNode: cannot get cell - "+e.className;return parseInt(t[0].substr(1,t[0].length-1),10)}function getCellFromEvent(e){var t=$(e.target).closest(".slick-cell",$canvas);return t.length?{row:0|t.parent().attr("row"),cell:getCellFromNode(t[0])}:null}function getCellNodeBox(e,t){if(!cellExists(e,t))return null;for(var o=e*options.rowHeight-offset,i=o+options.rowHeight-1,n=0,l=0;t>l;l++)n+=columns[l].width;var r=n+columns[t].width;return{top:o,left:n,bottom:i,right:r}}function resetActiveCell(){setActiveCellInternal(null,!1)}function setFocus(){$.browser.msie?$canvas[0].setActive():$canvas[0].focus()}function scrollActiveCellIntoView(){if(activeCellNode){var e=$(activeCellNode).position().left,t=e+$(activeCellNode).outerWidth(),o=$viewport.scrollLeft(),i=o+$viewport.width();o>e?$viewport.scrollLeft(e):t>i&&$viewport.scrollLeft(Math.min(e,t-$viewport[0].clientWidth))}}function setActiveCellInternal(e,t){null!==activeCellNode&&(makeActiveCellNormal(),$(activeCellNode).removeClass("active"));var o=activeCellNode!==e;activeCellNode=e,null!=activeCellNode?(activeRow=parseInt($(activeCellNode).parent().attr("row")),activeCell=activePosX=getCellFromNode(activeCellNode),$(activeCellNode).addClass("active"),options.editable&&t&&isCellPotentiallyEditable(activeRow,activeCell)?(clearTimeout(h_editorLoader),options.asyncEditorLoading?h_editorLoader=setTimeout(function(){makeActiveCellEditable()},options.asyncEditorLoadDelay):makeActiveCellEditable()):setFocus()):activeRow=activeCell=null,o&&(scrollActiveCellIntoView(),trigger(self.onActiveCellChanged,getActiveCell()))}function clearTextSelection(){if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){var e=window.getSelection();e&&e.removeAllRanges&&e.removeAllRanges()}}function isCellPotentiallyEditable(e,t){return e<getDataLength()&&!getDataItem(e)?!1:columns[t].cannotTriggerInsert&&e>=getDataLength()?!1:getEditor(e,t)?!0:!1}function makeActiveCellNormal(){if(currentEditor){if(trigger(self.onBeforeCellEditorDestroy,{editor:currentEditor}),currentEditor.destroy(),currentEditor=null,activeCellNode&&($(activeCellNode).removeClass("editable invalid"),getDataItem(activeRow))){var e=columns[activeCell];activeCellNode.innerHTML=getFormatter(activeRow,e)(activeRow,activeCell,getDataItem(activeRow)[e.field],e,getDataItem(activeRow)),invalidatePostProcessingResults(activeRow)}$.browser.msie&&clearTextSelection(),getEditorLock().deactivate(editController)}}function makeActiveCellEditable(e){if(activeCellNode){if(!options.editable)throw"Grid : makeActiveCellEditable : should never get called when options.editable is false";if(clearTimeout(h_editorLoader),isCellPotentiallyEditable(activeRow,activeCell)){var t=columns[activeCell],o=getDataItem(activeRow);if(trigger(self.onBeforeEditCell,{row:activeRow,cell:activeCell,item:o,column:t})===!1)return void setFocus();getEditorLock().activate(editController),$(activeCellNode).addClass("editable"),e||(activeCellNode.innerHTML=""),currentEditor=new(e||getEditor(activeRow,activeCell))({grid:self,gridPosition:absBox($container[0]),position:absBox(activeCellNode),container:activeCellNode,column:t,item:o||{},commitChanges:commitEditAndSetFocus,cancelChanges:cancelEditAndSetFocus}),o&&currentEditor.loadValue(o),serializedEditorValue=currentEditor.serializeValue(),currentEditor.position&&handleActiveCellPositionChange()}}}function commitEditAndSetFocus(){getEditorLock().commitCurrentEdit()&&(setFocus(),options.autoEdit&&navigateDown())}function cancelEditAndSetFocus(){getEditorLock().cancelCurrentEdit()&&setFocus()}function absBox(e){var t={top:e.offsetTop,left:e.offsetLeft,bottom:0,right:0,width:$(e).outerWidth(),height:$(e).outerHeight(),visible:!0};t.bottom=t.top+t.height,t.right=t.left+t.width;for(var o=e.offsetParent;(e=e.parentNode)!=document.body;)t.visible&&e.scrollHeight!=e.offsetHeight&&"visible"!=$(e).css("overflowY")&&(t.visible=t.bottom>e.scrollTop&&t.top<e.scrollTop+e.clientHeight),t.visible&&e.scrollWidth!=e.offsetWidth&&"visible"!=$(e).css("overflowX")&&(t.visible=t.right>e.scrollLeft&&t.left<e.scrollLeft+e.clientWidth),t.left-=e.scrollLeft,t.top-=e.scrollTop,e===o&&(t.left+=e.offsetLeft,t.top+=e.offsetTop,o=e.offsetParent),t.bottom=t.top+t.height,t.right=t.left+t.width;return t}function getActiveCellPosition(){return absBox(activeCellNode)}function getGridPosition(){return absBox($container[0])}function handleActiveCellPositionChange(){if(activeCellNode){var e;trigger(self.onActiveCellPositionChanged,{}),currentEditor&&(e=e||getActiveCellPosition(),currentEditor.show&&currentEditor.hide&&(e.visible?currentEditor.show():currentEditor.hide()),currentEditor.position&&currentEditor.position(e))}}function getCellEditor(){return currentEditor}function getActiveCell(){return activeCellNode?{row:activeRow,cell:activeCell}:null}function getActiveCellNode(){return activeCellNode}function scrollRowIntoView(e,t){var o=e*options.rowHeight,i=(e+1)*options.rowHeight-viewportH+(viewportHasHScroll?scrollbarDimensions.height:0);(e+1)*options.rowHeight>scrollTop+viewportH+offset?(scrollTo(t?o:i),render()):e*options.rowHeight<scrollTop+offset&&(scrollTo(t?i:o),render())}function getColspan(e,t){var o=data.getItemMetadata&&data.getItemMetadata(e);if(!o||!o.columns)return 1;var i=o.columns[columns[t].id]||o.columns[t],n=i&&i.colspan;return"*"===n&&(n=columns.length-t),n||1}function findFirstFocusableCell(e){for(var t=0;t<columns.length;){if(canCellBeActive(e,t))return t;t+=getColspan(e,t)}return null}function findLastFocusableCell(e){for(var t=0,o=null;t<columns.length;)canCellBeActive(e,t)&&(o=t),t+=getColspan(e,t);return o}function gotoRight(e,t){if(t>=columns.length)return null;do t+=getColspan(e,t);while(t<columns.length&&!canCellBeActive(e,t));return t<columns.length?{row:e,cell:t,posX:t}:null}function gotoLeft(e,t){if(0>=t)return null;var o=findFirstFocusableCell(e);if(null===o||o>=t)return null;for(var i,n={row:e,cell:o,posX:o};;){if(i=gotoRight(n.row,n.cell,n.posX),!i)return null;if(i.cell>=t)return n;n=i}}function gotoDown(e,t,o){for(var i;;){if(++e>=getDataLength()+(options.enableAddRow?1:0))return null;for(i=t=0;o>=t;)i=t,t+=getColspan(e,t);if(canCellBeActive(e,i))return{row:e,cell:i,posX:o}}}function gotoUp(e,t,o){for(var i;;){if(--e<0)return null;for(i=t=0;o>=t;)i=t,t+=getColspan(e,t);if(canCellBeActive(e,i))return{row:e,cell:i,posX:o}}}function gotoNext(e,t,o){var i=gotoRight(e,t,o);if(i)return i;for(var n=null;++e<getDataLength()+(options.enableAddRow?1:0);)if(n=findFirstFocusableCell(e),null!==n)return{row:e,cell:n,posX:n};return null}function gotoPrev(e,t,o){for(var i,n;!i&&!(i=gotoLeft(e,t,o));){if(--e<0)return null;t=0,n=findLastFocusableCell(e),null!==n&&(i={row:e,cell:n,posX:n})}return i}function navigateRight(){navigate("right")}function navigateLeft(){navigate("left")}function navigateDown(){navigate("down")}function navigateUp(){navigate("up")}function navigateNext(){navigate("next")}function navigatePrev(){navigate("prev")}function navigate(e){if(activeCellNode&&options.enableCellNavigation&&getEditorLock().commitCurrentEdit()){var t={up:gotoUp,down:gotoDown,left:gotoLeft,right:gotoRight,prev:gotoPrev,next:gotoNext},o=t[e],i=o(activeRow,activeCell,activePosX);if(i){var n=i.row==getDataLength();scrollRowIntoView(i.row,!n),setActiveCellInternal(getCellNode(i.row,i.cell),n||options.autoEdit),activePosX=i.posX}}}function getCellNode(e,t){if(rowsCache[e])for(var o,i=$(rowsCache[e]).children(),n=0;n<i.length;n++){if(o=getCellFromNode(i[n]),o===t)return i[n];if(o>t)return null}return null}function setActiveCell(e,t){e>getDataLength()||0>e||t>=columns.length||0>t||options.enableCellNavigation&&(scrollRowIntoView(e,!1),setActiveCellInternal(getCellNode(e,t),!1))}function canCellBeActive(e,t){if(!options.enableCellNavigation||e>=getDataLength()+(options.enableAddRow?1:0)||0>e||t>=columns.length||0>t)return!1;var o=data.getItemMetadata&&data.getItemMetadata(e);if(o&&"boolean"==typeof o.focusable)return o.focusable;var i=o&&o.columns;return i&&i[columns[t].id]&&"boolean"==typeof i[columns[t].id].focusable?i[columns[t].id].focusable:i&&i[t]&&"boolean"==typeof i[t].focusable?i[t].focusable:"boolean"==typeof columns[t].focusable?columns[t].focusable:!0}function canCellBeSelected(e,t){if(e>=getDataLength()||0>e||t>=columns.length||0>t)return!1;var o=data.getItemMetadata&&data.getItemMetadata(e);if(o&&"boolean"==typeof o.selectable)return o.selectable;var i=o&&o.columns&&(o.columns[columns[t].id]||o.columns[t]);return i&&"boolean"==typeof i.selectable?i.selectable:"boolean"==typeof columns[t].selectable?columns[t].selectable:!0}function gotoCell(e,t,o){if(canCellBeActive(e,t)&&getEditorLock().commitCurrentEdit()){scrollRowIntoView(e,!1);var i=getCellNode(e,t);setActiveCellInternal(i,o||e===getDataLength()||options.autoEdit),currentEditor||setFocus()}}function commitCurrentEdit(){var e=getDataItem(activeRow),t=columns[activeCell];if(currentEditor){if(currentEditor.isValueChanged()){var o=currentEditor.validate();if(o.valid){if(activeRow<getDataLength()){var i={row:activeRow,cell:activeCell,editor:currentEditor,serializedValue:currentEditor.serializeValue(),prevSerializedValue:serializedEditorValue,execute:function(){this.editor.applyValue(e,this.serializedValue),updateRow(this.row)},undo:function(){this.editor.applyValue(e,this.prevSerializedValue),updateRow(this.row)}};options.editCommandHandler?(makeActiveCellNormal(),options.editCommandHandler(e,t,i)):(i.execute(),makeActiveCellNormal()),trigger(self.onCellChange,{row:activeRow,cell:activeCell,item:e})}else{var n={};currentEditor.applyValue(n,currentEditor.serializeValue()),makeActiveCellNormal(),trigger(self.onAddNewRow,{item:n,column:t})}return!getEditorLock().isActive()}return $(activeCellNode).addClass("invalid"),$(activeCellNode).stop(!0,!0).effect("highlight",{color:"red"},300),trigger(self.onValidationError,{editor:currentEditor,cellNode:activeCellNode,validationResults:o,row:activeRow,cell:activeCell,column:t}),currentEditor.focus(),!1}makeActiveCellNormal()}return!0}function cancelCurrentEdit(){return makeActiveCellNormal(),!0}function rowsToRanges(e){for(var t=[],o=columns.length-1,i=0;i<e.length;i++)t.push(new Slick.Range(e[i],0,e[i],o));return t}function getSelectedRows(){if(!selectionModel)throw"Selection model is not set";return selectedRows}function setSelectedRows(e){if(!selectionModel)throw"Selection model is not set";selectionModel.setSelectedRanges(rowsToRanges(e))}var defaults={headerHeight:25,rowHeight:25,defaultColumnWidth:80,enableAddRow:!1,leaveSpaceForNewRows:!1,editable:!1,autoEdit:!0,enableCellNavigation:!0,enableCellRangeSelection:!1,enableColumnReorder:!0,asyncEditorLoading:!1,asyncEditorLoadDelay:100,forceFitColumns:!1,enableAsyncPostRender:!1,asyncPostRenderDelay:60,autoHeight:!1,editorLock:Slick.GlobalEditorLock,showHeaderRow:!1,headerRowHeight:25,showTopPanel:!1,topPanelHeight:25,formatterFactory:null,editorFactory:null,cellFlashingCssClass:"flashing",selectedCellCssClass:"selected",multiSelect:!0,enableTextSelectionOnCells:!1},columnDefaults={name:"",resizable:!0,sortable:!1,minWidth:30,rerenderOnResize:!1,headerCssClass:null},maxSupportedCssHeight,th,h,ph,n,cj,page=0,offset=0,scrollDir=1,$container,uid="slickgrid_"+Math.round(1e6*Math.random()),self=this,$headerScroller,$headers,$headerRow,$headerRowScroller,$topPanelScroller,$topPanel,$viewport,$canvas,$style,stylesheet,viewportH,viewportW,viewportHasHScroll,headerColumnWidthDiff,headerColumnHeightDiff,cellWidthDiff,cellHeightDiff,absoluteColumnMinWidth,activePosX,activeRow,activeCell,activeCellNode=null,currentEditor=null,serializedEditorValue,editController,rowsCache={},renderedRows=0,numVisibleRows,prevScrollTop=0,scrollTop=0,lastRenderedScrollTop=0,prevScrollLeft=0,avgRowRenderTime=10,selectionModel,selectedRows=[],plugins=[],cellCssClasses={},columnsById={},sortColumnId,sortAsc=!0,h_editorLoader=null,h_render=null,h_postrender=null,postProcessedRows={},postProcessToRow=null,postProcessFromRow=null,counter_rows_rendered=0,counter_rows_removed=0;this.debug=function(){var e="";e+="\ncounter_rows_rendered:  "+counter_rows_rendered,e+="\ncounter_rows_removed:  "+counter_rows_removed,e+="\nrenderedRows:  "+renderedRows,e+="\nnumVisibleRows:  "+numVisibleRows,e+="\nmaxSupportedCssHeight:  "+maxSupportedCssHeight,e+="\nn(umber of pages):  "+n,e+="\n(current) page:  "+page,e+="\npage height (ph):  "+ph,e+="\nscrollDir:  "+scrollDir,alert(e)},this.eval=function(expr){return eval(expr)},$.extend(this,{slickGridVersion:"2.0a1",onScroll:new Slick.Event,onSort:new Slick.Event,onHeaderContextMenu:new Slick.Event,onHeaderClick:new Slick.Event,onMouseEnter:new Slick.Event,onMouseLeave:new Slick.Event,onClick:new Slick.Event,onDblClick:new Slick.Event,onContextMenu:new Slick.Event,onKeyDown:new Slick.Event,onAddNewRow:new Slick.Event,onValidationError:new Slick.Event,onViewportChanged:new Slick.Event,onColumnsReordered:new Slick.Event,onColumnsResized:new Slick.Event,onCellChange:new Slick.Event,onBeforeEditCell:new Slick.Event,onBeforeCellEditorDestroy:new Slick.Event,onBeforeDestroy:new Slick.Event,onActiveCellChanged:new Slick.Event,onActiveCellPositionChanged:new Slick.Event,onDragInit:new Slick.Event,onDragStart:new Slick.Event,onDrag:new Slick.Event,onDragEnd:new Slick.Event,onSelectedRowsChanged:new Slick.Event,registerPlugin:registerPlugin,unregisterPlugin:unregisterPlugin,getColumns:getColumns,setColumns:setColumns,getColumnIndex:getColumnIndex,updateColumnHeader:updateColumnHeader,setSortColumn:setSortColumn,autosizeColumns:autosizeColumns,getOptions:getOptions,setOptions:setOptions,getData:getData,getDataLength:getDataLength,getDataItem:getDataItem,setData:setData,getSelectionModel:getSelectionModel,setSelectionModel:setSelectionModel,getSelectedRows:getSelectedRows,setSelectedRows:setSelectedRows,render:render,invalidate:invalidate,invalidateRow:invalidateRow,invalidateRows:invalidateRows,invalidateAllRows:invalidateAllRows,updateCell:updateCell,updateRow:updateRow,getViewport:getVisibleRange,resizeCanvas:resizeCanvas,updateRowCount:updateRowCount,scrollRowIntoView:scrollRowIntoView,getCanvasNode:getCanvasNode,getCellFromPoint:getCellFromPoint,getCellFromEvent:getCellFromEvent,getActiveCell:getActiveCell,setActiveCell:setActiveCell,getActiveCellNode:getActiveCellNode,getActiveCellPosition:getActiveCellPosition,resetActiveCell:resetActiveCell,editActiveCell:makeActiveCellEditable,getCellEditor:getCellEditor,getCellNode:getCellNode,getCellNodeBox:getCellNodeBox,canCellBeSelected:canCellBeSelected,canCellBeActive:canCellBeActive,navigatePrev:navigatePrev,navigateNext:navigateNext,navigateUp:navigateUp,navigateDown:navigateDown,navigateLeft:navigateLeft,navigateRight:navigateRight,gotoCell:gotoCell,getTopPanel:getTopPanel,showTopPanel:showTopPanel,hideTopPanel:hideTopPanel,showHeaderRowColumns:showHeaderRowColumns,hideHeaderRowColumns:hideHeaderRowColumns,getHeaderRow:getHeaderRow,getHeaderRowColumn:getHeaderRowColumn,getGridPosition:getGridPosition,flashCell:flashCell,addCellCssStyles:addCellCssStyles,setCellCssStyles:setCellCssStyles,removeCellCssStyles:removeCellCssStyles,destroy:destroy,getEditorLock:getEditorLock,getEditController:getEditController}),init()}$.extend(!0,window,{Slick:{Grid:SlickGrid}});var scrollbarDimensions}(jQuery),function(e){function t(t){function o(e,o,i,n,l){return t.enableExpandCollapse?"<span class='"+t.toggleCssClass+" "+(l.collapsed?t.toggleCollapsedCssClass:t.toggleExpandedCssClass)+"'></span>"+l.title:l.title}function i(e,t,o,i,n){return i.groupTotalsFormatter&&i.groupTotalsFormatter(n,i)||""}function n(e){d=e,d.onClick.subscribe(r),d.onKeyDown.subscribe(a)}function l(){d&&(d.onClick.unsubscribe(r),d.onKeyDown.unsubscribe(a))}function r(o,i){var n=this.getDataItem(i.row);n&&n instanceof Slick.Group&&e(o.target).hasClass(t.toggleCssClass)&&(n.collapsed?this.getData().expandGroup(n.value):this.getData().collapseGroup(n.value),o.stopImmediatePropagation(),o.preventDefault())}function a(o){if(t.enableExpandCollapse&&o.which==e.ui.keyCode.SPACE){var i=this.getActiveCell();if(i){var n=this.getDataItem(i.row);n&&n instanceof Slick.Group&&(n.collapsed?this.getData().expandGroup(n.value):this.getData().collapseGroup(n.value),o.stopImmediatePropagation(),o.preventDefault())}}}function s(){return{selectable:!1,focusable:t.groupFocusable,cssClasses:t.groupCssClass,columns:{0:{colspan:"*",formatter:o,editor:null}}}}function c(){return{selectable:!1,focusable:t.totalsFocusable,cssClasses:t.totalsCssClass,formatter:i,editor:null}}var d,u={groupCssClass:"slick-group",totalsCssClass:"slick-group-totals",groupFocusable:!0,totalsFocusable:!1,toggleCssClass:"slick-group-toggle",toggleExpandedCssClass:"expanded",toggleCollapsedCssClass:"collapsed",enableExpandCollapse:!0};return t=e.extend(!0,{},u,t),{init:n,destroy:l,getGroupRowMetadata:s,getTotalsRowMetadata:c}}e.extend(!0,window,{Slick:{Data:{GroupItemMetadataProvider:t}}})}(jQuery),function(e){function t(t){function o(){tt=!0}function i(e){tt=!1,F(e)}function n(e){e=e||0;for(var t,o=e,i=U.length;i>o;o++){if(t=U[o][Y],void 0===t)throw"Each data element must implement a unique 'id' property";Q[t]=o}}function l(){for(var e,t=0,o=U.length;o>t;t++)if(e=U[t][Y],void 0===e||Q[e]!==t)throw"Each data element must implement a unique 'id' property"}function r(){return U}function a(e,t){void 0!==t&&(Y=t),U=e,Q={},n(),l(),F()}function s(e){void 0!=e.pageSize&&(rt=e.pageSize),void 0!=e.pageNum&&(at=Math.min(e.pageNum,Math.ceil(st/rt))),ut.notify(c(),null,O),F()}function c(){return{pageSize:rt,pageNum:at,totalRows:st}}function d(e,t){ot=t,z=e,N=null,t===!1&&U.reverse(),U.sort(e),t===!1&&U.reverse(),Q={},n(),F()}function u(e,t){ot=t,N=e,z=null;var o=Object.prototype.toString;Object.prototype.toString="function"==typeof e?e:function(){return this[e]},t===!1&&U.reverse(),U.sort(),Object.prototype.toString=o,t===!1&&U.reverse(),Q={},n(),F()}function h(){z?d(z,ot):N&&u(N,ot)}function g(e){Z=e,F()}function p(e,o,i){t.groupItemMetadataProvider||(t.groupItemMetadataProvider=new Slick.Data.GroupItemMetadataProvider),V=e,B="function"==typeof V,G=o,j=i,nt={},it=[],F()}function f(e,t){X=e,lt=void 0!==t?t:lt,F()}function v(e){return U[e]}function m(e){return Q[e]}function w(e){if(!J){J={};for(var t=0,o=K.length;o>t;++t)J[K[t][Y]]=t}return J[e]}function C(e){return U[Q[e]]}function b(e,t){if(void 0===Q[e]||e!==t[Y])throw"Invalid or non-matching id";U[Q[e]]=t,et||(et={}),et[e]=!0,F()}function k(e,t){U.splice(e,0,t),n(e),F()}function R(e){U.push(e),n(U.length-1),F()}function y(e){var t=Q[e];if(void 0===t)throw"Invalid id";delete Q[e],U.splice(t,1),n(t),F()}function S(){return K.length}function E(e){return K[e]}function _(e){var o=K[e];return void 0===o?null:o.__group?t.groupItemMetadataProvider.getGroupRowMetadata(o):o.__groupTotals?t.groupItemMetadataProvider.getTotalsRowMetadata(o):null}function x(e){nt[e]=!0,F()}function $(e){delete nt[e],F()}function D(){return it}function P(e){for(var t,o,i,n=[],l={},r=0,a=e.length;a>r;r++)i=e[r],o=B?V(i):i[V],t=l[o],t||(t=new Slick.Group,t.count=0,t.value=o,t.rows=[],n[n.length]=t,l[o]=t),t.rows[t.count++]=i;return n}function T(e){var t,o;if(!e.collapsed||lt){for(o=X.length;o--;)X[o].init();for(var i=0,n=e.rows.length;n>i;i++)for(t=e.rows[i],o=X.length;o--;)X[o].accumulate(t);var l=new Slick.GroupTotals;for(o=X.length;o--;)X[o].storeResult(l);l.group=e,e.totals=l}}function M(e){for(var t=e.length;t--;)T(e[t])}function A(e){for(var t,o=e.length;o--;)t=e[o],t.collapsed=t.value in nt,t.title=G?G(t):t.value}function I(e){for(var t,o=[],i=0,n=0,l=e.length;l>n;n++){if(t=e[n],o[i++]=t,!t.collapsed)for(var r=0,a=t.rows.length;a>r;r++)o[i++]=t.rows[r];!t.totals||t.collapsed&&!lt||(o[i++]=t.totals)}return o}function H(e,t){var o,i=rt*at,n=i+rt,l=0,r=0,a=[];if(t)for(var s=0,c=e.length;c>s;++s)o=e[s],(!t||t(o))&&((!rt||l>=i&&n>l)&&(a[r]=o,r++),l++);else a=rt?e.slice(i,n):e.concat(),l=e.length;return{totalRows:l,rows:a}}function L(e,t){for(var o,i,n,l=[],r=0,a=e.length,s=t.length;s>r;r++)r>=a?l[l.length]=r:(o=t[r],i=e[r],(V&&(n=o.__nonDataRow||i.__nonDataRow)&&o.__group!==i.__group||o.__updated||o.__group&&!o.equals(i)||X&&n&&(o.__groupTotals||i.__groupTotals)||o[Y]!=i[Y]||et&&et[o[Y]])&&(l[l.length]=r));return l}function W(e,t,o){J=null;var i=[],n=H(e,o);st=n.totalRows,i=n.rows,it=[],null!=V&&(it=P(i),it.length&&(A(it),X&&M(it),it.sort(j),i=I(it)));var l=L(t,i);return K=i,l}function F(){if(!tt){var e=K.length,t=st,o=W(U,K,Z);rt&&at*rt>st&&(at=Math.floor(st/rt),o=W(U,K,Z)),et=null,t!=st&&ut.notify(c(),null,O),e!=K.length&&ct.notify({previous:e,current:K.length},null,O),o.length>0&&dt.notify({rows:o},null,O)}}var N,z,V,B,G,j,X,O=this,q={groupItemMetadataProvider:null},Y="id",U=[],K=[],Q={},J=null,Z=null,et=null,tt=!1,ot=!0,it=[],nt={},lt=!1,rt=0,at=0,st=0,ct=new Slick.Event,dt=new Slick.Event,ut=new Slick.Event;return t=e.extend(!0,{},q,t),{beginUpdate:o,endUpdate:i,setPagingOptions:s,getPagingInfo:c,getItems:r,setItems:a,setFilter:g,sort:d,fastSort:u,reSort:h,groupBy:p,setAggregators:f,collapseGroup:x,expandGroup:$,getGroups:D,getIdxById:m,getRowById:w,getItemById:C,getItemByIdx:v,refresh:F,updateItem:b,insertItem:k,addItem:R,deleteItem:y,getLength:S,getItem:E,getItemMetadata:_,onRowCountChanged:ct,onRowsChanged:dt,onPagingInfoChanged:ut}}function o(e){var t,o,i;this.init=function(){t=0,o=0,i=0},this.accumulate=function(n){var l=n[e];t++,null!=l&&0/0!=l&&(o++,i+=1*l)},this.storeResult=function(t){t.avg||(t.avg={}),0!=o&&(t.avg[e]=i/o)}}function i(e){var t;this.init=function(){t=null},this.accumulate=function(o){var i=o[e];null!=i&&0/0!=i&&(null==t||t>i)&&(t=i)},this.storeResult=function(o){o.min||(o.min={}),o.min[e]=t}}function n(e){var t;this.init=function(){t=null},this.accumulate=function(o){var i=o[e];null!=i&&0/0!=i&&(null==t||i>t)&&(t=i)},this.storeResult=function(o){o.max||(o.max={}),o.max[e]=t}}e.extend(!0,window,{Slick:{Data:{DataView:t,Aggregators:{Avg:o,Min:i,Max:n}}}})}(jQuery),function(e){var t=function(e,t,o,i,n){var l="./"+n.name,r='<a href="'+l+'">'+o+"</a>";return r},o=function(e,t,o,i,n){var l=n.profile_url,r='<a href="'+l+'">'+o+"</a>";return r},i=function(e,t,o){var i=o.substring(0,4),n=o.substring(5,7),l=o.substring(8,10);"0"==n.charAt(0)&&(n=n.substring(1)),"0"==l.charAt(0)&&(l=l.substring(1));var r=(window.head_data||{}).date_format;r||(r=karl_client_data.date_format);var a=new Date(i,n-1,l),s=Globalize.format(a,"d",Globalize.culture(r));return s};e.widget("karl.karlwikitoc",{options:{},_create:function(){function n(e,t){var o=e[l.sortCol].toLowerCase(),i=t[l.sortCol].toLowerCase();return o==i?0:o>i?1:-1}var l=this,r='<a href="#" class="karl-wikitoc-button-inspector">Options</a>',a="karl-wikitoc-footer ui-widget-header";this.element.append('<div class="karl-wikitoc-gridwrapper ui-helper-clearfix"><div class="karl-wikitoc-widthconstrainer"><div class="karl-wikitoc-grid"></div></div><div class="karl-wikitoc-inspector"><div class="karl-wikitoc-inspector-wrapper"><div class="karl-wikitoc-inspector-wrapper2"><fieldset class="karl-wikitoc-livesearch"><legend>Find in text</legend><div><p>Letters anywhere in title, tags, or author</p><div><span class="karl-wikitoc-icon-search ui-icon ui-icon-search"></span><input class="karl-wikitoc-input-livesearch" type="text"></input></div><div class="ui-helper-clearfix"></div></div></fieldset><fieldset class="karl-wikitoc-grouping"><legend>Grouping</legend><div><p>Column, if any, to group by</p><div><input type="checkbox" class="karl-wikitoc-cb-grouping"></input><label>Group by tags</label></div></div></fieldset><fieldset class="karl-wikitoc-columnselectors"><legend>Columns</legend><div><p>Which columns to show in the grid, in addition to title</p><div><input class="karl-wikitoc-cb-title" type="checkbox" checked="checked"></input><label>Title</label></div><div><input class="karl-wikitoc-cb-author_name" type="checkbox" checked="checked"></input><label>Author</label></div><div><input class="karl-wikitoc-cb-tags" type="checkbox"></input><label>Tags</label></div><div><input class="karl-wikitoc-cb-created" type="checkbox" checked="checked"></input><label>Created</label></div><div><input class="karl-wikitoc-cb-modified" type="checkbox"></input><label>Modified</label></div></div></fieldset></div></div></div></div><div class="'+a+'"><span class="karl-wikitoc-items"><span class="karl-wikitoc-items-num">0</span> items</span>'+r+"</div>"),this.el_gridwrapper=this.element.find(".karl-wikitoc-gridwrapper"),this.el_widthconstrainer=this.element.find(".karl-wikitoc-widthconstrainer"),this.el_grid=this.el_gridwrapper.find(".karl-wikitoc-grid"),this.el_inspector=this.el_gridwrapper.find(".karl-wikitoc-inspector"),this.el_columnselectors=this.el_inspector.find(".karl-wikitoc-columnselectors"),this.el_footer=this.element.find(".karl-wikitoc-footer"),this.el_button_inspector=this.el_footer.find(".karl-wikitoc-button-inspector"),this.el_input_livesearch=this.el_inspector.find(".karl-wikitoc-input-livesearch"),this.el_cb_grouping=this.el_inspector.find(".karl-wikitoc-cb-grouping"),this.el_label_items_num=this.el_footer.find(".karl-wikitoc-items-num"),this.inspector_width=e(".karl-wikitoc-inspector-wrapper").width(),this.el_column_selectors={title:this.el_inspector.find(".karl-wikitoc-cb-title"),author_name:this.el_inspector.find(".karl-wikitoc-cb-author_name"),tags:this.el_inspector.find(".karl-wikitoc-cb-tags"),created:this.el_inspector.find(".karl-wikitoc-cb-created"),modified:this.el_inspector.find(".karl-wikitoc-cb-modified")},e.each(this.el_column_selectors,function(e,t){t.click(function(){l.grid_columns=l.grid.getColumns(),l.filterGridColumns(),l.grid.setColumns(l.grid_columns)})}),this.el_button_inspector.button({icons:{primary:"ui-icon-triangle-1-w"}}),this.el_button_inspector.click(function(e){return l.grid_columns=l.grid.getColumns(),l.toggleInspector(e),!1}),this.searchString="",this.el_input_livesearch.keyup(function(e){Slick.GlobalEditorLock.cancelCurrentEdit(),27==e.which&&(this.value=""),l.searchString=this.value,l.dataView.refresh()}),this.el_cb_grouping.click(function(){var t=e(this).is(":checked");t?l.enableGrouping():l.disableGrouping()}),this.el_grid.find(".slick-row").live("mouseenter mouseleave",function(t){var o=e(this);
o.is(".slick-group")||("mouseenter"==t.type?o.addClass("karl-wikitoc-grid-row-hover"):o.removeClass("karl-wikitoc-grid-row-hover"))}),this.inactive_columns={},this.grid_columns=[{id:"title",name:"Title",field:"title",formatter:t,width:320,minWidth:20,sortable:!0},{id:"author_name",name:"Author",field:"author_name",formatter:o,width:80,minWidth:20,sortable:!0},{id:"tags",name:"Tags",field:"tags",width:140,minWidth:20,sortable:!1},{id:"created",name:"Created",field:"created",formatter:i,width:60,minWidth:20,sortable:!0},{id:"modified",name:"Modified",field:"modified",formatter:i,width:60,minWidth:20,sortable:!0}],this.filterGridColumns();var s=this.grid_columns,c={enableCellNavigation:!0,editable:!1,forceFitColumns:!0,rowHeight:this.options.rowHeight,headerHeight:this.options.headerHeight},d=new Slick.Data.GroupItemMetadataProvider,u=this.dataView=new Slick.Data.DataView({groupItemMetadataProvider:d}),h=this.grid=new Slick.Grid(this.el_grid,u,s,c);h.registerPlugin(d),this.sortCol="title",this.sortDir=1,h.onSort.subscribe(function(e,t){l.sortDir=t.sortAsc?1:-1,l.sortCol=t.sortCol.field,u.sort(n,t.sortAsc)}),u.onRowCountChanged.subscribe(function(){h.updateRowCount(),h.render()}),u.onRowsChanged.subscribe(function(e,t){h.invalidateRows(t.rows),h.render()}),u.beginUpdate(),u.setItems(this.options.items),u.setFilter(function(e){return l._contentFilter(e)}),h.setSortColumn(this.sortCol,this.sortDir),u.sort(n,1==this.sortDir),u.endUpdate(),this.el_label_items_num.text(this.options.items.length),this.grid.setColumns(this.grid_columns)},_addFakeRecords:function(){var t=this;if(!this._fake_records_added){this._fake_records_added=!0,this.dataView.beginUpdate();var o=this.dataView.getItems();e.each(o,function(o,i){var n=i.tags;i.original=!0,0===n.length?i.effective_tag="":(i.effective_tag=n[0],e.each(n,function(o,n){if(0!==o){var l=e.extend({},i,{effective_tag:n,original:!1});t.dataView.addItem(l)}}))}),this.dataView.endUpdate()}},enableGrouping:function(){this.groupingEnabled=!0,this._addFakeRecords(),this.dataView.groupBy("effective_tag",function(e){return""!==e.value?'<span class="karl-wikitoc-groupheader">Tag: '+e.value+"</span>":'<span class="karl-wikitoc-groupheader">Untagged:</span>'},function(e,t){var o=e.value.toLowerCase(),i=t.value.toLowerCase();return o==i?0:""===o?1:""===i?-1:i>o?-1:1})},disableGrouping:function(){this.groupingEnabled=!1,this.dataView.groupBy(null)},_contentFilter:function(t){if(!this.groupingEnabled&&this._fake_records_added&&!t.original)return!1;var o=this.searchString.toLowerCase();if(""===o)return!0;if(-1!=t.title.toLowerCase().indexOf(o))return!0;if(-1!=t.author_name.toLowerCase().indexOf(o))return!0;var i=!1;return e.each(t.tags,function(e,t){return-1!=t.toLowerCase().indexOf(o)?(i=!0,!1):void 0}),i},filterGridColumns:function(){var t=this,o=this.inactive_columns;e.each(o,function(i,n){var l=n.data,r=t.el_column_selectors[i].is(":checked");if(r){var a=[],s=!1;n.prev_column||(a.push(l),s=!0),e.each(t.grid_columns,function(e,t){a.push(t),n.prev_column&&t.id==n.prev_column.id&&(a.push(l),s=!0)}),s||a.push(l),delete o[i],t.grid_columns=a}});var i=[],n=null;e.each(this.grid_columns,function(e,l){var r=l.id,a=t.el_column_selectors[r].is(":checked");a?i.push(l):o[l.id]={data:l,prev_column:n},n=l}),this.grid_columns=i},toggleInspector:function(){var t=this;if(!this.inspector_button_locked){this.inspector_button_locked=!0;var o=this.inspector_width,i=this._inspector_open,n=this._inspector_open=!i,l=this.el_widthconstrainer.width();if(n)this.el_button_inspector.button("option","icons",{primary:"ui-icon-triangle-1-e"}),this.el_inspector.animate({width:""+o+"px"},{complete:function(){var i=(l-o)/l;e.each(t.grid_columns,function(e,t){t.width=Math.round(t.width*i)}),t.el_widthconstrainer.width(l-o),t.grid.resizeCanvas(),t.grid.setColumns(t.grid_columns),t.inspector_button_locked=!1}});else{this.el_button_inspector.button("option","icons",{primary:"ui-icon-triangle-1-w"}),this.el_inspector.animate({width:"0px"},{complete:function(){t.inspector_button_locked=!1}}),this.el_widthconstrainer.css("width","100%"),this.grid.resizeCanvas();var r=(l+o)/l;e.each(this.grid_columns,function(e,t){t.width=Math.round(t.width*r)}),this.grid.setColumns(this.grid_columns)}}},resizeColumns:function(){if(!this.inspector_button_locked){this.inspector_button_locked=!0;var t=this.el_gridwrapper.width();this._inspector_open&&(t-=this.inspector_width,this.el_widthconstrainer.width(t));var o=0;e.each(this.grid_columns,function(e,t){o+=t.width});this.grid.autosizeColumns(),this.grid.resizeCanvas(),this.grid.setColumns(this.grid_columns);var i=this.element.find(".slick-header-column"),n=i.eq(0),l=parseInt(n.css("padding-left"),10)+parseInt(n.css("padding-right"),10),r=this.headerColumnPadding-l;this.element.find(".slick-header-column").each(function(){var t=e(this);t.width(t.width()+r)}),this.inspector_button_locked=!1}}})}(jQuery);
//# sourceMappingURL=karl-wikitoc.min.js.map
