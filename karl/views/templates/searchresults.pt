<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="layout">

<head>
  <metal:slot metal:fill-slot="extra-headers">
    <script src="${api.static_url}/jquery-plugins/jquery.timeago.js"></script>
    <script language="javascript" type="text/javascript">
      //<![CDATA[
      $(document).ready(function() {
          $("abbr.timeago").timeago();
      });
      //]]>
    </script>
  </metal:slot>
</head>

<div metal:fill-slot="content"><br/>

<div class="row">
  <form method="GET" action=""
        tal:attributes="action request.path_url">
      <div class="form-inline col col-lg-12" align="right">
          <input class="form-control input-sm" id="ls-current-searchterm" name="body" type="text"
            value="" tal:attributes="value request.params.get('body', '')" />
          <input class="btn btn-default btn-sm" id="sras-searchbutton" type="submit"
                 value="Search"/><br/><br/>
          <span class="sras-discreet clearfix">
              About ${total} results (${elapsed} seconds)
          </span>
      </div>
  </form>
</div><br/>

<div id="sras-content clearfix">
    <div class="sras-searchknobs container" tal:condition="show_search_knobs">
      <div class="row">
        
<!-- Search options -->
        <div class="sras-searchknobgroup" tal:condition="scope_knob">
          <div class="col col-lg-3">  
            <ul class="list-unstyled">
                <li tal:repeat="o scope_knob">
                    <a href="${o['url']}" tal:omit-tag="o['selected']">
                        <strong tal:omit-tag="not o['selected']">
                            ${o['name']}</strong></a>
                </li>
            </ul>
          </div>
        </div>

        <div class="sras-searchknobgroup sras-searchcontent">
          <div class="col col-lg-3">
            <ul class="list-unstyled">
                <li tal:repeat="o kind_knob">
                    <img src="${api.static_url}/images/${o['icon']}"
                         alt="${o['title']}" tal:condition="o['icon']"/>
                    <a href="${o['url']}" tal:omit-tag="o['selected']">
                        <strong tal:omit-tag="not o['selected']">
                          ${o['title']}</strong></a>
                </li>
            </ul>
          </div>
        </div>

        <div class="sras-searchknobgroup">
          <div class="col col-lg-3">  
            <ul class="list-unstyled">
                <li tal:repeat="o since_knob">
                    <a href="${o['url']}" tal:omit-tag="o['selected']">
                        <strong tal:omit-tag="not o['selected']">
                            ${o['name']}</strong></a>
                </li>
            </ul>
          </div>  
        </div>

        <div class="sras-searchknobgroup">
          <div class="col col-lg-3">  
            <ul class="list-unstyled">
                <li tal:repeat="o sort_knob">
                    <a href="${o['url']}" tal:omit-tag="o['selected']">
                        <strong tal:omit-tag="not o['selected']">
                            ${o['name']}</strong></a>
                </li>
            </ul>
          </div>
        </div>
      </div><br/> <!-- /.row -->

<!-- Search inputs at bottom of page -->
        <div class="sras-searchknobgroup last container">
            <form method="GET" class="form-inline">
              <div class="form-group">
                <tal:block repeat="name params" omit-tag="">
                    <input type="hidden" name="${name}"
                           tal:condition="name != 'creator'"
                           value="${params[name]}"/>
                </tal:block>
                <label>Author</label>
                <input class="form-control input-sm" type="text"
                       name="creator" value="${params.get('creator', '')}"
                       onChange="this.form.submit()"/>
                <input class="btn btn-default btn-sm" id="sras-authorknob" type="submit" value="Search" />
              </div>
            </form><br/>
            <form method="GET" class="form-inline">
              <div class="form-group">
                <tal:block repeat="name params" omit-tag="">
                    <input type="hidden" name="${name}"
                           tal:condition="name != 'tags'"
                           value="${params[name]}"/>
                </tal:block>
                <label>Tag</label>
                <input class="form-control input-sm"
                       name="tags" value="${params.get('tags', '')}"
                       onChange="this.form.submit()"/>
                <input class="btn btn-default btn-sm" id="sras-tagknob" type="submit" value="Search" />
              </div>
            </form><br/>
        </div>

    </div>
    <script type="text/javascript">
$(document).ready(function(){
    $('#sras-searchbutton, #sras-authorknob, #sras-tagknob').button();
 });
    </script>

<!-- Search Results -->
    <div id="sras-results">
      <div class="search-error" tal:condition="error">${error}</div>
      <ul class="list-group">
        <tal:loop repeat="r results">
        <li class="list-group-item">
        <tal:var define="result_display r['result_display'];
                         doc result_display.context">
          <metal:searchresult
              use-macro="api.snippets.macros[result_display.macro]">
          </metal:searchresult>
        </tal:var></li>
      </tal:loop>
      </ul>
    </div>

    <div id="sras-pagination" tal:condition="batch_info['batching_required']">
        <metal:script metal:use-macro="api.snippets.macros['gridstyle_batching_script']" />
        <table class="table table-striped" width="100%">
          <tr class="ui-grid-footer">
            <th class="ui-widget-header">
              <div metal:use-macro="api.snippets.macros['gridstyle_batching']">
              </div>
            </th>
          </tr>
        </table>
    </div>

</div>

</div>

</html>
