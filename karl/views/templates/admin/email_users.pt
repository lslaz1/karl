<html xmlns="http://www.w3.org/1999/xhtml"
     xmlns:tal="http://xml.zope.org/namespaces/tal"
     xmlns:metal="http://xml.zope.org/namespaces/metal"
     metal:use-macro="api.generic_layout">

  <span metal:fill-slot="extra-headers" tal:omit-tag="">
    <div metal:use-macro="api.snippets.macros['tinymce_js']"/>
  </span>

  <div metal:fill-slot="portlets">
    <div metal:use-macro="menu"/>
  </div>

  <div metal:fill-slot="content">
    <div metal:use-macro="api.snippets.macros['status_message']"/>
    <div metal:use-macro="api.snippets.macros['error_message']"/>

    <div class="admin_page_body">
      <h1 class="kscreentitle">Admin Section: Email Users</h1>

      <div class="koverview_body">
        <form method="POST" name="email_users" enctype="multipart/form-data">
          <b>From</b><br/>
          <select name="from_email">
            <option tal:repeat="from_email from_emails"
                    value="${from_email[0]}">${from_email[1]}</option>
          </select><br/>
          <br/>
          <b>To</b><br/>
          <select name="to_group">
            <option tal:repeat="to_group to_groups"
                    value="${to_group[0]}">${to_group[1]}</option>
          </select><br/>
          <br/>
          <b>Subject</b><br/>
          <input name="subject" size="60"/><br/>
          <br/>
          <metal:input use-macro="api.formfields.macros['text-field']"/>
          <br/>
          
          <fieldset id="attachment-field"
			      metal:define-macro="attachment-field"
			      tal:define="error fielderrors['attachment']|None"
		              tal:condition="api.support_attachments"
			      class="${error and 'fieldError' or ''}">
		      <label>Attachment</label>
		      <div class="fieldHelp"></div>
		      <div tal:condition="error" class="errorMessage">${error}</div>
		      <div class="muf-widget">
		        <div class="muf-stub">
		          <input type="file" value="true" name="attachment"/>
		          <a href="#" class="muf-closebutton">Remove</a>
		        </div>
		        <a href="#" class="muf-addbutton">Attach another file</a>
		      </div>
		      <script language="javascript" type="text/javascript">
		        $(document).ready(function() {
		            // create the widget
		            $('#attachment-field .muf-widget')
		                .karlmultiupload({
		                });
		        });
		      </script>
		    </fieldset>
          
          
          <input type="submit" name="send_email" value="Send Email"/>
        </form>
      </div>
    </div>

  </div>

</html>
