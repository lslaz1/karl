<html xmlns="http://www.w3.org/1999/xhtml"
     xmlns:tal="http://xml.zope.org/namespaces/tal"
     xmlns:metal="http://xml.zope.org/namespaces/metal"
     metal:use-macro="api.generic_layout">

<head>
<metal:block metal:fill-slot="extra-headers">
<script src="${api.static_url}/jquery-plugins/jquery.timeago.js"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
    $("abbr.timeago").timeago();
});
</script>
</metal:block>
</head>

  <div metal:fill-slot="content">
    <div metal:use-macro="api.snippets.macros['status_message']"/>
    <div metal:use-macro="api.snippets.macros['error_message']"/>

    <h1 class="kscreentitle">Review Access Requests</h1>

    <form method="POST" class="access-request-review">
      <table class="table table-striped table-bordered table-hover">
        <thead>
          <tal:fields tal:repeat="field fields">
            <th>${field['label']}</th>
          </tal:fields>
          <th>Email</th>
          <th>Date Requested</th>
          <th>Review Decision</th>
          <th>Email Template</th>
        </thead>
        <tbody>
          <tal:req tal:repeat="req access_requests">
            <tr tal:define="date python: format_date(req['date_requested'])">
              <tal:fields tal:repeat="field fields">   
                <td>${python: req.get(field['id'])}</td>
              </tal:fields>
              <td>${python: req['email']}</td>
              <td><abbr class="timeago" title=${date}>${date}</abbr></td>
              <td>
                <select name="rvw_ch">
                  <option tal:repeat="rvw_choice review_choices"
                    value="${rvw_choice[0]}">${rvw_choice[1]}</option>
                </select>
              </td>
              <td>
                <select name="templ_ch">
                  <option tal:repeat="e_template response_templates"
                    value="${e_template[0]}">${e_template[1]}</option>
                </select>
              </td>
            </tr>
          </tal:req>
        </tbody>
      </table>
      <div class="formControlls loginLeftPadding">
        <input type="hidden" name="form.submitted" value="1" />

        <div class="buttons clearafter">
          <button name="image" type="submit" id="signin" class="button primary_button"><span>Submit changes</span></button>
        </div>
      </div>
    </form>


    <a href="${api.app_url}/review_invitations.html">
      Review Outstanding Site Invitations
    </a>

  </div>

</html>
